doctype html
html(lang="de")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    meta(name="theme-color" content="#0f172a")

    meta(name="msapplication-TileColor" content="#ffffff")
    meta(name="msapplication-TileImage" content="/favicon.svg")
    link(rel="icon" type="image/svg+xml" href="/favicon.svg")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png")
    link(rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png")
    link(rel="icon" type="image/png" sizes="512x512" href="/favicon-512.png")
    //link(rel="manifest" href="/manifest.json")

    title #{typeof title !== 'undefined' ? title : 'Bewerbungs-Tracker'}
    link(rel="stylesheet", href="/styles.css")

body
    a.skip-link(href="#main") Zum Inhalt springen
    header.site-header(role="banner")
      a.brand(href="/")
        span.logo ◼
        span.brand-text Bewerbungs-Tracker
      nav.main-nav(role="navigation" aria-label="Hauptnavigation")
        ul
          li: a(href="/jobs" aria-current=(currentPath==='/jobs' ? 'page' : null)) Übersicht
          li: a(href="/jobs/new" aria-current=(currentPath==='/jobs/new' ? 'page' : null)) Neuer Job
          li: a(href="/companies" aria-current=(currentPath==='/companies' ? 'page' : null)) Unternehmen

    div#live-region(role="status" aria-live="polite" class="sr-only")

    main#main(role="main" tabindex="-1")
      block content

    footer(role="contentinfo")
      p made by 
        a(href="http://github.com/wieerwill") WieErWill

script.
    (function(){
      async function copyJob(jobId, btn){
        try{
          const res = await fetch(`/api/jobs/${encodeURIComponent(jobId)}?format=markdown`);
          if(!res.ok){ throw new Error('HTTP '+res.status); }
          const text = await res.text();
          await navigator.clipboard.writeText(text);
          if(btn){ const old=btn.textContent; btn.textContent='Kopiert!'; btn.disabled=true; setTimeout(()=>{btn.textContent=old; btn.disabled=false;}, 1200); }
        }catch(err){
          alert('Kopieren fehlgeschlagen. Details in der Konsole.');
          console.error('copyJob failed', err);
        }
      }
      document.addEventListener('click', (e)=>{
        const t = e.target;
        if(t && t.classList && t.classList.contains('js-copy-job')){
          const jobId = t.getAttribute('data-jobid');
          if(jobId) copyJob(jobId, t);
        }
      });
    })();

    document.addEventListener('submit', (e)=>{
      const form = e.target;
      if(!(form instanceof HTMLFormElement)) return;
      const btn = form.querySelector('button[type="submit"]');
      if(btn){ btn.setAttribute('disabled','true'); setTimeout(()=>btn.removeAttribute('disabled'), 1500); }
    });

    // Focus main on navigation (helps SR & keyboard users)
    if(document && location){
      const main = document.getElementById('main');
      main && main.focus();
    }